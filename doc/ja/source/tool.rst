関連ツール
=====================

``to_dft.py``
******************************

本ツールでは、Si等四面体構造のボンドネットワークを有する系の(001)および(111)表面系モデルについて、
その原子構造から第一原理電子状態計算ソフトウェア `Quantum Espresso (QE) <https://www.quantum-espresso.org/>`_ 用の入力データを作成する。これにより、得られた構造の妥当性検証や、電子状態等の微視的な情報を取得する。
なお、注目する表面と反対の表面から生じるダングリングボンド由来の電子の影響を排除するため、最下層のダングリングボンドの位置に水素原子を置く水素終端というテクニックを用いている。


必要な環境
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
- Python3

また、以下のパッケージが必要である。

- `Atomic Simulation Environment(ASE) <https://wiki.fysik.dtu.dk/ase>`_
- Numpy
- Scipy
- Matplotlib
  
スクリプトの概要
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

XYZ形式に2次元的な周期構造を表すための格子ベクトルの情報を加えた入力ファイルを読み込み、
得られた座標データから、最下層と、その次の層にあたる原子の座標を抽出する。
最下層の原子は取り除き、対応する位置に H 原子を置いて次層の原子との距離を四面体構造となる距離(例えば、Siの場合はシラン分子となる距離)に調整したモデルを作成する。
水素終端を行ったモデルはXYZ形式で、入力ファイル名を少し改変した 〇〇〇_ext.xyz として保存される。
また、ASEの機能を利用し、cifファイルとQEの入力ファイルも作成する。

チュートリアル
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

1. 実行時の引数として元となる(行末に二次元格子ベクトルのデータを含んだ)XYZファイルを渡す。
以下では、 ``tool/todft/sample`` フォルダにある ``surf_bulk_new111.xyz`` を用いる。
ファイルの中身は以下の通りである。

.. code-block::

   12
    surf.txt             / bulk.txt
    Si    1.219476    0.000000    4.264930
    Si    6.459844    0.000000    4.987850
    Si    1.800417    1.919830    3.404650
    Si    5.878903    1.919830    3.404650
    Si    3.839660    1.919830    2.155740
    Si    0.000000    1.919830    1.900440
    Si    3.839660    0.000000    0.743910
    Si    0.000000    0.000000    0.597210
    Si    1.919830    0.000000   -0.678750
    Si    5.759490    0.000000   -0.678750
    Si    1.919830    1.919830   -2.036250
    Si    5.759490    1.919830   -2.036250
         7.67932     0.00000
         0.00000     3.83966

最後の2行は周期構造の格子ベクトルの情報が記載されている。

2. 以下のコマンドを実行する。

.. code-block::

    python3 trhepd.py surf_bulk_new111.xyz


これを実行すると、

- ``surf_bulk_new111_ext.xyz``
- ``surf_bulk_new111.cif``
- ``espresso.pwi``

が生成される。 以下、順に出力ファイルについて説明する。

- ``surf_bulk_new111_ext.xyz``

最下層原子のHへの置換と四面体構造を形成するためのHの追加が行われた結果が出力される。

.. code-block::

    14
    Lattice="7.67932 0.0 0.0  0.0 3.83966 0.0  0.0 0.0 17.0241" Properties=species:S:1:pos:R:3 pbc="T T T"
    Si  1.219476  0.000000  4.264930
    Si  6.459844  0.000000  4.987850
    Si  1.800417  1.919830  3.404650
    Si  5.878903  1.919830  3.404650
    Si  3.839660  1.919830  2.155740
    Si  0.000000  1.919830  1.900440
    Si  3.839660  0.000000  0.743910
    Si  0.000000  0.000000  0.597210
    Si  1.919830  0.000000  -0.678750
    Si  5.759490  0.000000  -0.678750
    H  1.919830  -1.208630  -1.532925
    H  1.919830  1.208630  -1.532925
    H  5.759490  -1.208630  -1.532925
    H  5.759490  1.208630  -1.532925

このファイルは通常のXYZ形式の座標データとして適当な可視化ソフト等に読ませることができるが、通常コメントを書く場所に周期構造の格子ベクトルの情報が書き込まれている。
出力されたファイルの3行目以降の「元素名+3次元座標」のデータをそのままQEの入力ファイルにコピーして使用する事もできる。

``espresso.pwi`` はQEのscf計算用の入力ファイルであり、
構造最適化やバンド計算は本ファイルを適宜修正することで行うことができる。
各種設定については `QEのオンラインマニュアル <https://www.quantum-espresso.org/Doc/INPUT_PW.html>`_ を参考のこと。
